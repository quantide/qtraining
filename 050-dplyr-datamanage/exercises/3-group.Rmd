---
title: 
author:
date: 
output:
  html_document:
    self_contained: no
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
library(knitr) 
options(width=80)
opts_chunk$set(list(dev = 'png', fig.cap='', fig.show='hold', dpi=100, fig.width=7, fig.height=7, fig.pos='H!'))#, fig.path="figures/lm-"))
source("r/show-solution.R")
# ATTENZIONE: leggere nota dentro show-solution.R
```

Grouping data
================================

## `group_by()`
Note: all the exercises of this section are based on the `flights` dataset.

```{r require, results='hide', message=FALSE}
library(dplyr)
library(nycflights13)
```


### Exercise 1
Calculate number of flights, minimum, mean and maximum delay at arrival for flights by month.

```{r ex1, echo=show_solution, eval=show_solution}
flights_by_month <- group_by(flights, month)
summarise(flights_by_month,
          n = n(),
          min_delay = min(arr_delay, na.rm = TRUE),
          max_delay = max(arr_delay, na.rm = TRUE),
          mean_delay = mean(arr_delay, na.rm = TRUE))
```


### Exercise 2
Calculate number of flights, mean delay at departure and arrival for flights by origin.

```{r ex2, echo=show_solution, eval=show_solution}
flights_by_origin <- group_by(flights, origin)
summarise(flights_by_origin,
          n = n(),
          mean_dep_delay = mean(dep_delay, na.rm = TRUE),
          mean_arr_delay = mean(arr_delay, na.rm = TRUE))
```


### Exercise 3
Calculate the number of planes and the number of flights that go to each possible destination.

```{r ex3, echo=show_solution, eval=show_solution}
destinations <- group_by(flights, dest)
summarise(destinations,
          planes = n_distinct(tailnum),
          flights = n())
```


### Exercise 4
Calculate the number of flights for each day. Save the result in a data frame called `per_day`.

```{r ex4, echo=show_solution, eval=show_solution}
daily <- group_by(flights, year, month, day)
(per_day <- summarise(daily, flights = n()))
```


### Exercise 5
By exploiting `per_day`, calculate the number of flights for each month. Save the result in a data frame called `per_month`.

```{r ex5, echo=show_solution, eval=show_solution}
(per_month <- summarise(per_day, flights = sum(flights)))
```


### Exercise 6
Calculate the mean daily number of flights per month.

```{r ex6, echo=show_solution, eval=show_solution}
n_days <- c(31,28,31,30,31,30,31,31,30,31,30,31)
mutate(per_month, n_days = n_days, daily_mean = flights / n_days)
```

