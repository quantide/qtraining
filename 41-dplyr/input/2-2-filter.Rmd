---
title: "Filter Data"
---

```{r options, include=FALSE, purl=FALSE}
source("options.R")
```

```{r first, include=FALSE, purl=TRUE, message=FALSE}
# This code chunk contains R code already described in the previous chapters
# that is required by following examples
require(dplyr)
require(qdata)
data(bank)
```


# `filter()`

`filter()` allows you to select a subset of the rows of a data frame.

![](images/fil.png) 

The first argument is the name of the data frame, and the second and subsequent are filtering expressions evaluated in the context of that data frame.

For example, you can select all calls made on 2008-05-05 to students:

<!-- AS spiegare date nell'esempio sotto -->

```{r}
filter(bank, job == "student", balance > 20000)
filter(bank, job == "student", as.character(date) == "2008-05-05")
filter(bank, job == "student", date == ymd("2008-05-05"))
```


This is equivalent to the more verbose:

<!--- AS add example with balance --> 

```{r}
bank[bank$date == ymd("2008-05-05") & bank$job == "student", ]
```

`filter()` works similarly to `subset()` except that you can give it any number of filtering conditions which are joined together with `&` (not `&&` which is easy to do accidentally!). 

You can use other boolean operators explicitly:

```{r}
filter(bank, age == 18 | age == 95)
```

`filter()` can be used also with `%in%` to establish conditions under which filter: 

```{r}
filter(bank, age %in% c(18,95))
```

An other example is:

```{r}
filter(bank, job %in% c("admin.","technician"))
filter(bank, job == "admin." | job == "technician")
```


# `slice()`
To select rows by position, use `slice()`:

For example, you can select, respectively, the first 10 calls or the last call of the dataset as follow:

```{r}
slice(bank, 1:5)
```
<!-- AS spiegare esempio esotto -->

```{r}
# select last row of the dataset
slice(bank, n()) 
```


# `sample_n()` and `sample_frac()`

You can use `sample_n()` and `sample_frac()` to take a random sample of rows, either a fixed number for `sample_n()` or a fixed fraction for `sample_frac()`.

```{r}
sample_n(bank, 3)
```

```{r}
sample_frac(bank, 0.0001)
sample_frac(bank, 1.5, replace = TRUE)
```

Use `replace = TRUE` to perform a bootstrap sample, and optionally weight the sample with the weight argument.

