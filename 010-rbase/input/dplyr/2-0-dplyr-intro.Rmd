---
title: "Introduction to `dplyr`"
---

```{r options, include=FALSE, purl=FALSE}
source("options.R")
```

```{r first, include=FALSE, purl=TRUE, message=FALSE}
# This code chunk contains R code already described in the previous chapters
# that is required by following examples
require(dplyr)
require(qdata)
data(bank)
```


# Introduction

The `dplyr` package for `R` is very powerful for data management since:

* it simplifies how you can think about common data manipulation tasks;
* it provides simple “verbs”, functions that correspond to the most common data manipulation tasks;
* it uses efficient data storage backends, so you spend less time waiting for the computer.

Let's start by having a look at how data frames are saved and visualized and at the main verb functions of `dplyr`.


# `tbl_df`: the `dplyr` Data Frame Class

`dplyr` can work with data frames as is but it is worthwhile to convert them to a `tbl_df`: this is a wrapper around a data frame that will not accidentally print a lot of data to the screen, indeed tbl objects only print a few rows and all the columns that fit on one screen, describing the rest of it as text.

```{r tbl_df_bank}
data(bank)
class(bank)
bank
```

When the class of data object is not tbl, `tbl_df()` function should be used:

```{r tbl_df}
# Example of data frame
df <- setNames(object = data.frame(matrix(data = runif(2000), nrow = 100, ncol = 20)),
               nm = letters[1:20])
class(df)
head(df)
# dplyr version of the same data frame
dfd <- tbl_df(df)
class(dfd)
dfd
```


# Verb functions

`dplyr` aims to provide a function for each basic verb of data manipulating.

All these functions are very similar:

* the first argument is a data frame;
* the subsequent arguments describe what to do with it, and you can refer to columns in the data frame directly without using $;
* the result is a new data frame.

Together these properties make it easy to chain together multiple simple steps to achieve a complex result.

These five functions provide the basis of a language of data manipulation. At the most basic level, you can only alter a tidy data frame in five useful ways: 

1. select variables of interest: `select()`;
2. filter records of interest: `filter()`;
3. reorder the rows: `arrange()`;
4. add new variables that are functions of existing variables: `mutate()`;
5. collapse many values to a summary: `summarise()`. 

The remainder of the language comes from applying these five functions to different types of data, like grouped data, which will be described after.
